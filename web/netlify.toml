[build]
  base = "web"
  command = "npm run build"
  # publish é relativo ao base; como base=web, deve ser ".next" (e não "web/.next")
  publish = ".next"

[build.environment]
  NEXT_PUBLIC_API_BASE = "https://lifeflourishconsulting.netlify.app"

[[plugins]]
  package = "@netlify/plugin-nextjs"

# Se você ainda usa a Function Express (/.netlify/functions/api),
# este fallback manda /api/* para a Function quando não existir rota Next API.
[[redirects]]
  from = "/api/*"
  to   = "/.netlify/functions/api/:splat"
  status = 200
  force = true

# Garante que /api/dev-jwt funcione via Function existente enquanto depura.
[[redirects]]
  from = "/api/dev-jwt"
  to   = "/.netlify/functions/dev-jwt"
  status = 200
  force = true
